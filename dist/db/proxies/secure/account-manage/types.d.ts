import { FromSchema } from 'json-schema-to-ts';
import { EntityKeys } from '../../../../entity/types';
import { LoginUser } from '../types';
import { userSecretSchema, pendingUserSchema } from './schema';
export declare type PendingUser = FromSchema<typeof pendingUserSchema>;
export declare type UserSecret = FromSchema<typeof userSecretSchema>;
export declare type AccountManageEntityMap = {
    pendingUser: PendingUser;
    userSecret: UserSecret;
};
export declare const accountManageEntityKeys: EntityKeys<AccountManageEntityMap>;
export declare type AccountFns = {
    createPendingUser: CreatePendingUser;
    verifyPendingUser: VerifyPendingUser;
    createSecret: CreateSecret;
    userForSecret: UserForSecret;
    forgotPassword: ForgotPassword;
    resetPassword: ResetPassword;
    cleanSecrets: CleanSecrets;
    cleanPendingUsers: CleanPendingUsers;
    tempSecretForUser: TempSecretForUser;
};
export declare type SecretType = 'api-key' | 'forgot-password' | 'temp';
export declare type CreatePendingUser = (user: LoginUser) => Promise<string>;
export declare type VerifyPendingUser = (secret: string) => Promise<string>;
export declare type CreateSecret = (userName: string, type?: SecretType) => Promise<string>;
export declare type UserForSecret = (secret: string, type?: SecretType) => Promise<string>;
export declare type ForgotPassword = (userName: string) => Promise<string>;
export declare type ResetPassword = (secret: string, newPassword: string) => Promise<void>;
export declare type CleanSecrets = (maxAgeMs: number) => Promise<void>;
export declare type CleanPendingUsers = (maxAgeMs: number) => Promise<void>;
export declare type TempSecretForUser = (userName: string) => Promise<string>;
